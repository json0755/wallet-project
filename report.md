# Aderyn Analysis Report

This report was generated by [Aderyn](https://github.com/Cyfrin/aderyn), a static analysis tool built by [Cyfrin](https://cyfrin.io), a blockchain security company. This report is not a substitute for manual audit or security review. It should not be relied upon for any purpose other than to assist in the identification of potential security vulnerabilities.
# Table of Contents

- [Summary](#summary)
  - [Files Summary](#files-summary)
  - [Files Details](#files-details)
  - [Issue Summary](#issue-summary)
- [High Issues](#high-issues)
  - [H-1: Arbitrary `from` Passed to `transferFrom`](#h-1-arbitrary-from-passed-to-transferfrom)
  - [H-2: Unprotected initializer](#h-2-unprotected-initializer)
  - [H-3: Unsafe Casting of integers](#h-3-unsafe-casting-of-integers)
  - [H-4: Contract Name Reused in Different Files](#h-4-contract-name-reused-in-different-files)
  - [H-5: Yul block contains `return`](#h-5-yul-block-contains-return)
  - [H-6: Contract locks Ether without a withdraw function](#h-6-contract-locks-ether-without-a-withdraw-function)
  - [H-7: Reentrancy: State change after external call](#h-7-reentrancy-state-change-after-external-call)
- [Low Issues](#low-issues)
  - [L-1: `delegatecall` in loop](#l-1-delegatecall-in-loop)
  - [L-2: Centralization Risk](#l-2-centralization-risk)
  - [L-3: Unsafe ERC20 Operation](#l-3-unsafe-erc20-operation)
  - [L-4: Unspecific Solidity Pragma](#l-4-unspecific-solidity-pragma)
  - [L-5: Address State Variable Set Without Checks](#l-5-address-state-variable-set-without-checks)
  - [L-6: Public Function Not Used Internally](#l-6-public-function-not-used-internally)
  - [L-7: Literal Instead of Constant](#l-7-literal-instead-of-constant)
  - [L-8: Unsafe `ERC721::_mint()`](#l-8-unsafe-erc721mint)
  - [L-9: PUSH0 Opcode](#l-9-push0-opcode)
  - [L-10: Empty Block](#l-10-empty-block)
  - [L-11: Large Numeric Literal](#l-11-large-numeric-literal)
  - [L-12: Internal Function Used Only Once](#l-12-internal-function-used-only-once)
  - [L-13: Inconsistent uint256/uint (or) int256/int types](#l-13-inconsistent-uint256uint-or-int256int-types)
  - [L-14: Loop Contains `require`/`revert`](#l-14-loop-contains-requirerevert)
  - [L-15: Local Variable Shadows State Variable](#l-15-local-variable-shadows-state-variable)
  - [L-16: Costly operations inside loop](#l-16-costly-operations-inside-loop)
  - [L-17: Missing Inheritance](#l-17-missing-inheritance)
  - [L-18: Unused Import](#l-18-unused-import)
  - [L-19: State Change Without Event](#l-19-state-change-without-event)
  - [L-20: State Variable Could Be Immutable](#l-20-state-variable-could-be-immutable)


# Summary

## Files Summary

| Key | Value |
| --- | --- |
| .sol Files | 25 |
| Total nSLOC | 1828 |


## Files Details

| Filepath | nSLOC |
| --- | --- |
| src/AirdopMerkleNFTMarket/AirdopMerkleNFTMarket.sol | 130 |
| src/AirdopMerkleNFTMarket/AirdropNFT.sol | 50 |
| src/AirdopMerkleNFTMarket/MerkleProof.sol | 60 |
| src/AirdopMerkleNFTMarket/Multicall.sol | 54 |
| src/AirdopMerkleNFTMarket/MulticallHelper.sol | 90 |
| src/AirdopMerkleNFTMarket/PermitToken.sol | 22 |
| src/BaseERC20.sol | 69 |
| src/BaseERC721.sol | 206 |
| src/Counter.sol | 10 |
| src/Delegate.sol | 87 |
| src/NFTMarket.sol | 64 |
| src/TransparentProxy.sol | 83 |
| src/UUPSProxy.sol | 83 |
| src/call/ContractA.sol | 27 |
| src/call/ContractB.sol | 13 |
| src/delegatecall/CallComparison.sol | 36 |
| src/delegatecall/Proxy.sol | 36 |
| src/delegatecall/Storage.sol | 19 |
| src/esRNT.sol | 14 |
| src/tokenbank/EIP2612Token.sol | 55 |
| src/tokenbank/EIP2612TokenBank.sol | 98 |
| src/tokenbank/Permit2.sol | 113 |
| src/upgrade/NFTMarketV1.sol | 126 |
| src/upgrade/NFTMarketV2.sol | 253 |
| src/upgrade/UpgradeableNFT.sol | 30 |
| **Total** | **1828** |


## Issue Summary

| Category | No. of Issues |
| --- | --- |
| High | 7 |
| Low | 20 |


# High Issues

## H-1: Arbitrary `from` Passed to `transferFrom`

Passing an arbitrary `from` address to `transferFrom` (or `safeTransferFrom`) can lead to loss of funds, because anyone can transfer tokens from the `from` address if an approval is made.

<details><summary>1 Found Instances</summary>


- Found in src/tokenbank/Permit2.sol [Line: 142](src/tokenbank/Permit2.sol#L142)

	```solidity
	        bool success = IERC20(permit.permitted.token).transferFrom(
	```

</details>



## H-2: Unprotected initializer

Consider protecting the initializer functions with modifiers.

<details><summary>2 Found Instances</summary>


- Found in src/TransparentProxy.sol [Line: 58](src/TransparentProxy.sol#L58)

	```solidity
	    function init(uint x) public {
	```

- Found in src/UUPSProxy.sol [Line: 67](src/UUPSProxy.sol#L67)

	```solidity
	    function init(uint x) public {
	```

</details>



## H-3: Unsafe Casting of integers

Downcasting int/uints in Solidity can be unsafe due to the potential for data loss and unintended behavior.When downcasting a larger integer type to a smaller one (e.g., uint256 to uint128), the value may exceed the range of the target type,leading to truncation and loss of significant digits. Use OpenZeppelin's SafeCast library to safely downcast integers.

<details><summary>1 Found Instances</summary>


- Found in src/tokenbank/EIP2612TokenBank.sol [Line: 112](src/tokenbank/EIP2612TokenBank.sol#L112)

	```solidity
	        PERMIT2.transferFrom(msg.sender, address(this), uint160(assets), address(asset()));
	```

</details>



## H-4: Contract Name Reused in Different Files

When compiling contracts with certain development frameworks (for example: Truffle), having contracts with the same name across different files can lead to one being overwritten.

<details><summary>8 Found Instances</summary>


- Found in src/BaseERC20.sol [Line: 10](src/BaseERC20.sol#L10)

	```solidity
	interface IERC20 {
	```

- Found in src/Counter.sol [Line: 4](src/Counter.sol#L4)

	```solidity
	contract Counter {
	```

- Found in src/TransparentProxy.sol [Line: 9](src/TransparentProxy.sol#L9)

	```solidity
	library StorageSlot {
	```

- Found in src/TransparentProxy.sol [Line: 41](src/TransparentProxy.sol#L41)

	```solidity
	contract Counter {
	```

- Found in src/TransparentProxy.sol [Line: 85](src/TransparentProxy.sol#L85)

	```solidity
	contract CounterV2 {
	```

- Found in src/UUPSProxy.sol [Line: 9](src/UUPSProxy.sol#L9)

	```solidity
	library StorageSlot {
	```

- Found in src/UUPSProxy.sol [Line: 42](src/UUPSProxy.sol#L42)

	```solidity
	contract Counter {
	```

- Found in src/UUPSProxy.sol [Line: 122](src/UUPSProxy.sol#L122)

	```solidity
	contract CounterV2 {
	```

</details>



## H-5: Yul block contains `return`

This causes the transaction execution to halt, and nothing after that call will execute including code following the assembly block.

<details><summary>2 Found Instances</summary>


- Found in src/TransparentProxy.sol [Line: 177](src/TransparentProxy.sol#L177)

	```solidity
	                return(0, returndatasize())
	```

- Found in src/UUPSProxy.sol [Line: 210](src/UUPSProxy.sol#L210)

	```solidity
	                return(0, returndatasize())
	```

</details>



## H-6: Contract locks Ether without a withdraw function

It appears that the contract includes a payable function to accept Ether but lacks a corresponding function to withdraw it, which leads to the Ether being locked in the contract. To resolve this issue, please implement a public or external function that allows for the withdrawal of Ether from the contract.

<details><summary>3 Found Instances</summary>


- Found in src/AirdopMerkleNFTMarket/AirdopMerkleNFTMarket.sol [Line: 16](src/AirdopMerkleNFTMarket/AirdopMerkleNFTMarket.sol#L16)

	```solidity
	contract AirdopMerkleNFTMarket is Multicall, ReentrancyGuard, Ownable {
	```

- Found in src/TransparentProxy.sol [Line: 117](src/TransparentProxy.sol#L117)

	```solidity
	contract TransparentProxy  {
	```

- Found in src/UUPSProxy.sol [Line: 158](src/UUPSProxy.sol#L158)

	```solidity
	contract UUPSProxy  {
	```

</details>



## H-7: Reentrancy: State change after external call

Changing state after an external call can lead to re-entrancy attacks.Use the checks-effects-interactions pattern to avoid this issue.

<details><summary>26 Found Instances</summary>


- Found in src/AirdopMerkleNFTMarket/AirdopMerkleNFTMarket.sol [Line: 87](src/AirdopMerkleNFTMarket/AirdopMerkleNFTMarket.sol#L87)

	State is changed at: `listings[tokenId] = Listing({
            tokenId: tokenId,
            seller: msg.sender,
            price: price,
            active: true
        })`
	```solidity
	        require(nft.ownerOf(tokenId) == msg.sender, "Not NFT owner");
	```

- Found in src/AirdopMerkleNFTMarket/AirdopMerkleNFTMarket.sol [Line: 88](src/AirdopMerkleNFTMarket/AirdopMerkleNFTMarket.sol#L88)

	State is changed at: `listings[tokenId] = Listing({
            tokenId: tokenId,
            seller: msg.sender,
            price: price,
            active: true
        })`
	```solidity
	        require(nft.getApproved(tokenId) == address(this) || nft.isApprovedForAll(msg.sender, address(this)), "NFT not approved");
	```

- Found in src/AirdopMerkleNFTMarket/AirdopMerkleNFTMarket.sol [Line: 135](src/AirdopMerkleNFTMarket/AirdopMerkleNFTMarket.sol#L135)

	State is changed at: `_permitData[owner] = PermitData({
            owner: owner,
            spender: spender,
            value: value,
            deadline: deadline,
            v: v,
            r: r,
            s: s
        })`
	```solidity
	        token.permit(owner, spender, value, deadline, v, r, s);
	```

- Found in src/AirdopMerkleNFTMarket/AirdopMerkleNFTMarket.sol [Line: 165](src/AirdopMerkleNFTMarket/AirdopMerkleNFTMarket.sol#L165)

	State is changed at: `hasClaimed[msg.sender] = true`, `listing.active = false`
	```solidity
	        require(nft.ownerOf(tokenId) == listing.seller, "Seller no longer owns NFT");
	```

- Found in src/AirdopMerkleNFTMarket/AirdopMerkleNFTMarket.sol [Line: 171](src/AirdopMerkleNFTMarket/AirdopMerkleNFTMarket.sol#L171)

	State is changed at: `hasClaimed[msg.sender] = true`, `listing.active = false`
	```solidity
	        require(IERC20(address(token)).allowance(msg.sender, address(this)) >= discountedPrice, "Insufficient allowance");
	```

- Found in src/AirdopMerkleNFTMarket/AirdopMerkleNFTMarket.sol [Line: 174](src/AirdopMerkleNFTMarket/AirdopMerkleNFTMarket.sol#L174)

	State is changed at: `hasClaimed[msg.sender] = true`, `listing.active = false`
	```solidity
	        require(IERC20(address(token)).transferFrom(msg.sender, listing.seller, discountedPrice), "Token transfer failed");
	```

- Found in src/AirdopMerkleNFTMarket/AirdopMerkleNFTMarket.sol [Line: 177](src/AirdopMerkleNFTMarket/AirdopMerkleNFTMarket.sol#L177)

	State is changed at: `hasClaimed[msg.sender] = true`, `listing.active = false`
	```solidity
	        nft.transferFrom(listing.seller, msg.sender, tokenId);
	```

- Found in src/AirdopMerkleNFTMarket/AirdopMerkleNFTMarket.sol [Line: 196](src/AirdopMerkleNFTMarket/AirdopMerkleNFTMarket.sol#L196)

	State is changed at: `listing.active = false`
	```solidity
	        require(nft.ownerOf(tokenId) == listing.seller, "Seller no longer owns NFT");
	```

- Found in src/AirdopMerkleNFTMarket/AirdopMerkleNFTMarket.sol [Line: 199](src/AirdopMerkleNFTMarket/AirdopMerkleNFTMarket.sol#L199)

	State is changed at: `listing.active = false`
	```solidity
	        require(IERC20(address(token)).allowance(msg.sender, address(this)) >= listing.price, "Insufficient allowance");
	```

- Found in src/AirdopMerkleNFTMarket/AirdopMerkleNFTMarket.sol [Line: 202](src/AirdopMerkleNFTMarket/AirdopMerkleNFTMarket.sol#L202)

	State is changed at: `listing.active = false`
	```solidity
	        require(IERC20(address(token)).transferFrom(msg.sender, listing.seller, listing.price), "Token transfer failed");
	```

- Found in src/AirdopMerkleNFTMarket/AirdopMerkleNFTMarket.sol [Line: 205](src/AirdopMerkleNFTMarket/AirdopMerkleNFTMarket.sol#L205)

	State is changed at: `listing.active = false`
	```solidity
	        nft.transferFrom(listing.seller, msg.sender, tokenId);
	```

- Found in src/NFTMarket.sol [Line: 42](src/NFTMarket.sol#L42)

	State is changed at: `listings[nftAddress][tokenId] = Listing({
            seller: msg.sender,
            nftAddress: nftAddress,
            tokenId: tokenId,
            price: price,
            active: true
        })`
	```solidity
	        require(nft.ownerOf(tokenId) == msg.sender, "You are not an NFT holder"); // 必须是持有者
	```

- Found in src/NFTMarket.sol [Line: 43](src/NFTMarket.sol#L43)

	State is changed at: `listings[nftAddress][tokenId] = Listing({
            seller: msg.sender,
            nftAddress: nftAddress,
            tokenId: tokenId,
            price: price,
            active: true
        })`
	```solidity
	        require(
	```

- Found in src/NFTMarket.sol [Line: 65](src/NFTMarket.sol#L65)

	State is changed at: `item.active = false`
	```solidity
	        require(paymentToken.allowance(msg.sender, address(this)) >= item.price, "Token authorization is insufficient"); // 检查授权
	```

- Found in src/NFTMarket.sol [Line: 66](src/NFTMarket.sol#L66)

	State is changed at: `item.active = false`
	```solidity
	        require(paymentToken.balanceOf(msg.sender) >= item.price, "Token balance is insufficient"); // 检查余额
	```

- Found in src/NFTMarket.sol [Line: 68](src/NFTMarket.sol#L68)

	State is changed at: `item.active = false`
	```solidity
	        require(paymentToken.transferFrom(msg.sender, item.seller, item.price), "Token transfer failed");
	```

- Found in src/NFTMarket.sol [Line: 71](src/NFTMarket.sol#L71)

	State is changed at: `item.active = false`
	```solidity
	        nft.transferFrom(item.seller, msg.sender, tokenId);
	```

- Found in src/NFTMarket.sol [Line: 95](src/NFTMarket.sol#L95)

	State is changed at: `item.active = false`
	```solidity
	        require(paymentToken.transfer(item.seller, amount), "Token transfer failed");
	```

- Found in src/NFTMarket.sol [Line: 98](src/NFTMarket.sol#L98)

	State is changed at: `item.active = false`
	```solidity
	        nft.transferFrom(item.seller, from, tokenId);
	```

- Found in src/delegatecall/CallComparison.sol [Line: 29](src/delegatecall/CallComparison.sol#L29)

	State is changed at: `lastCaller = msg.sender`
	```solidity
	        (bool success, ) = targetContract.call(data);
	```

- Found in src/upgrade/NFTMarketV1.sol [Line: 120](src/upgrade/NFTMarketV1.sol#L120)

	State is changed at: `listings[nftContract][tokenId] = Listing({
            tokenId: tokenId,
            price: price,
            seller: msg.sender,
            isActive: true
        })`
	```solidity
	        require(IERC721(nftContract).ownerOf(tokenId) == msg.sender, "Not token owner");
	```

- Found in src/upgrade/NFTMarketV1.sol [Line: 121](src/upgrade/NFTMarketV1.sol#L121)

	State is changed at: `listings[nftContract][tokenId] = Listing({
            tokenId: tokenId,
            price: price,
            seller: msg.sender,
            isActive: true
        })`
	```solidity
	        require(
	```

- Found in src/upgrade/NFTMarketV2.sol [Line: 186](src/upgrade/NFTMarketV2.sol#L186)

	State is changed at: `listings[nftContract][tokenId] = Listing({
             tokenId: tokenId,
             price: price,
             seller: msg.sender,
             isActive: true
         })`
	```solidity
	         require(IERC721(nftContract).ownerOf(tokenId) == msg.sender, "Not token owner");
	```

- Found in src/upgrade/NFTMarketV2.sol [Line: 187](src/upgrade/NFTMarketV2.sol#L187)

	State is changed at: `listings[nftContract][tokenId] = Listing({
             tokenId: tokenId,
             price: price,
             seller: msg.sender,
             isActive: true
         })`
	```solidity
	         require(
	```

- Found in src/upgrade/NFTMarketV2.sol [Line: 306](src/upgrade/NFTMarketV2.sol#L306)

	State is changed at: `nonces[signer]++`, `listings[nftContract][params.tokenId] = Listing({
            tokenId: params.tokenId,
            price: params.price,
            seller: signer,
            isActive: true
        })`
	```solidity
	        require(IERC721(nftContract).ownerOf(params.tokenId) == signer, "Signer not token owner");
	```

- Found in src/upgrade/NFTMarketV2.sol [Line: 310](src/upgrade/NFTMarketV2.sol#L310)

	State is changed at: `nonces[signer]++`, `listings[nftContract][params.tokenId] = Listing({
            tokenId: params.tokenId,
            price: params.price,
            seller: signer,
            isActive: true
        })`
	```solidity
	        require(
	```

</details>



# Low Issues

## L-1: `delegatecall` in loop

Using `delegatecall` in loop may consume excessive gas, or worse, lead to more severe issues.

<details><summary>3 Found Instances</summary>


- Found in src/AirdopMerkleNFTMarket/Multicall.sol [Line: 17](src/AirdopMerkleNFTMarket/Multicall.sol#L17)

	```solidity
	        for (uint256 i = 0; i < data.length; i++) {
	```

- Found in src/AirdopMerkleNFTMarket/Multicall.sol [Line: 47](src/AirdopMerkleNFTMarket/Multicall.sol#L47)

	```solidity
	        for (uint256 i = 0; i < data.length; i++) {
	```

- Found in src/AirdopMerkleNFTMarket/Multicall.sol [Line: 68](src/AirdopMerkleNFTMarket/Multicall.sol#L68)

	```solidity
	        for (uint256 i = 0; i < data.length; i++) {
	```

</details>



## L-2: Centralization Risk

Contracts have owners with privileged rights to perform admin tasks and need to be trusted to not perform malicious updates or drain funds.

<details><summary>25 Found Instances</summary>


- Found in src/AirdopMerkleNFTMarket/AirdopMerkleNFTMarket.sol [Line: 16](src/AirdopMerkleNFTMarket/AirdopMerkleNFTMarket.sol#L16)

	```solidity
	contract AirdopMerkleNFTMarket is Multicall, ReentrancyGuard, Ownable {
	```

- Found in src/AirdopMerkleNFTMarket/AirdopMerkleNFTMarket.sol [Line: 76](src/AirdopMerkleNFTMarket/AirdopMerkleNFTMarket.sol#L76)

	```solidity
	    function updateMerkleRoot(bytes32 _merkleRoot) external onlyOwner {
	```

- Found in src/AirdopMerkleNFTMarket/AirdropNFT.sol [Line: 12](src/AirdopMerkleNFTMarket/AirdropNFT.sol#L12)

	```solidity
	contract AirdropNFT is ERC721, ERC721URIStorage, Ownable {
	```

- Found in src/AirdopMerkleNFTMarket/AirdropNFT.sol [Line: 28](src/AirdopMerkleNFTMarket/AirdropNFT.sol#L28)

	```solidity
	    function setMarketContract(address _marketContract) external onlyOwner {
	```

- Found in src/AirdopMerkleNFTMarket/AirdropNFT.sol [Line: 38](src/AirdopMerkleNFTMarket/AirdropNFT.sol#L38)

	```solidity
	    function mint(address to, string memory uri) public onlyOwner returns (uint256) {
	```

- Found in src/AirdopMerkleNFTMarket/AirdropNFT.sol [Line: 54](src/AirdopMerkleNFTMarket/AirdropNFT.sol#L54)

	```solidity
	    function batchMint(address to, string[] memory uris) external onlyOwner returns (uint256[] memory) {
	```

- Found in src/AirdopMerkleNFTMarket/PermitToken.sol [Line: 12](src/AirdopMerkleNFTMarket/PermitToken.sol#L12)

	```solidity
	contract PermitToken is ERC20, ERC20Permit, Ownable {
	```

- Found in src/AirdopMerkleNFTMarket/PermitToken.sol [Line: 26](src/AirdopMerkleNFTMarket/PermitToken.sol#L26)

	```solidity
	    function mint(address to, uint256 amount) external onlyOwner {
	```

- Found in src/AirdopMerkleNFTMarket/PermitToken.sol [Line: 35](src/AirdopMerkleNFTMarket/PermitToken.sol#L35)

	```solidity
	    function batchMint(address[] calldata recipients, uint256[] calldata amounts) external onlyOwner {
	```

- Found in src/tokenbank/EIP2612Token.sol [Line: 13](src/tokenbank/EIP2612Token.sol#L13)

	```solidity
	contract EIP2612Token is ERC20, ERC20Permit, Ownable {
	```

- Found in src/tokenbank/EIP2612Token.sol [Line: 59](src/tokenbank/EIP2612Token.sol#L59)

	```solidity
	    function mint(address to, uint256 amount) public onlyOwner {
	```

- Found in src/tokenbank/EIP2612Token.sol [Line: 76](src/tokenbank/EIP2612Token.sol#L76)

	```solidity
	    function burn(address from, uint256 amount) public onlyOwner {
	```

- Found in src/tokenbank/EIP2612Token.sol [Line: 94](src/tokenbank/EIP2612Token.sol#L94)

	```solidity
	    function transferOwnership(address newOwner) public override onlyOwner {
	```

- Found in src/tokenbank/EIP2612Token.sol [Line: 117](src/tokenbank/EIP2612Token.sol#L117)

	```solidity
	    function emergencyPause() external onlyOwner {
	```

- Found in src/tokenbank/EIP2612TokenBank.sol [Line: 48](src/tokenbank/EIP2612TokenBank.sol#L48)

	```solidity
	contract EIP2612TokenBank is ERC4626, Ownable, ReentrancyGuard {
	```

- Found in src/upgrade/NFTMarketV1.sol [Line: 209](src/upgrade/NFTMarketV1.sol#L209)

	```solidity
	    function setPlatformFeeRate(uint256 _platformFeeRate) external onlyOwner {
	```

- Found in src/upgrade/NFTMarketV1.sol [Line: 218](src/upgrade/NFTMarketV1.sol#L218)

	```solidity
	    function setFeeRecipient(address _feeRecipient) external onlyOwner {
	```

- Found in src/upgrade/NFTMarketV1.sol [Line: 247](src/upgrade/NFTMarketV1.sol#L247)

	```solidity
	    function _authorizeUpgrade(address newImplementation) internal override onlyOwner {}
	```

- Found in src/upgrade/NFTMarketV2.sol [Line: 275](src/upgrade/NFTMarketV2.sol#L275)

	```solidity
	     function setPlatformFeeRate(uint256 _platformFeeRate) external onlyOwner {
	```

- Found in src/upgrade/NFTMarketV2.sol [Line: 284](src/upgrade/NFTMarketV2.sol#L284)

	```solidity
	     function setFeeRecipient(address _feeRecipient) external onlyOwner {
	```

- Found in src/upgrade/NFTMarketV2.sol [Line: 422](src/upgrade/NFTMarketV2.sol#L422)

	```solidity
	    ) external onlyOwner {
	```

- Found in src/upgrade/NFTMarketV2.sol [Line: 449](src/upgrade/NFTMarketV2.sol#L449)

	```solidity
	    function _authorizeUpgrade(address newImplementation) internal override onlyOwner {}
	```

- Found in src/upgrade/UpgradeableNFT.sol [Line: 39](src/upgrade/UpgradeableNFT.sol#L39)

	```solidity
	    function mint(address to, uint256 tokenId) public onlyOwner {
	```

- Found in src/upgrade/UpgradeableNFT.sol [Line: 48](src/upgrade/UpgradeableNFT.sol#L48)

	```solidity
	    function batchMint(address to, uint256[] memory tokenIds) public onlyOwner {
	```

- Found in src/upgrade/UpgradeableNFT.sol [Line: 58](src/upgrade/UpgradeableNFT.sol#L58)

	```solidity
	    function setBaseURI(string memory baseURI) public onlyOwner {
	```

</details>



## L-3: Unsafe ERC20 Operation

ERC20 functions may not behave as expected. For example: return values are not always meaningful. It is recommended to use OpenZeppelin's SafeERC20 library.

<details><summary>12 Found Instances</summary>


- Found in src/AirdopMerkleNFTMarket/AirdopMerkleNFTMarket.sol [Line: 174](src/AirdopMerkleNFTMarket/AirdopMerkleNFTMarket.sol#L174)

	```solidity
	        require(IERC20(address(token)).transferFrom(msg.sender, listing.seller, discountedPrice), "Token transfer failed");
	```

- Found in src/AirdopMerkleNFTMarket/AirdopMerkleNFTMarket.sol [Line: 202](src/AirdopMerkleNFTMarket/AirdopMerkleNFTMarket.sol#L202)

	```solidity
	        require(IERC20(address(token)).transferFrom(msg.sender, listing.seller, listing.price), "Token transfer failed");
	```

- Found in src/AirdopMerkleNFTMarket/AirdropNFT.sol [Line: 81](src/AirdopMerkleNFTMarket/AirdropNFT.sol#L81)

	```solidity
	        super.approve(to, tokenId);
	```

- Found in src/NFTMarket.sol [Line: 68](src/NFTMarket.sol#L68)

	```solidity
	        require(paymentToken.transferFrom(msg.sender, item.seller, item.price), "Token transfer failed");
	```

- Found in src/NFTMarket.sol [Line: 95](src/NFTMarket.sol#L95)

	```solidity
	        require(paymentToken.transfer(item.seller, amount), "Token transfer failed");
	```

- Found in src/tokenbank/Permit2.sol [Line: 142](src/tokenbank/Permit2.sol#L142)

	```solidity
	        bool success = IERC20(permit.permitted.token).transferFrom(
	```

- Found in src/upgrade/NFTMarketV1.sol [Line: 164](src/upgrade/NFTMarketV1.sol#L164)

	```solidity
	            payable(feeRecipient).transfer(platformFee);
	```

- Found in src/upgrade/NFTMarketV1.sol [Line: 166](src/upgrade/NFTMarketV1.sol#L166)

	```solidity
	        payable(seller).transfer(sellerAmount);
	```

- Found in src/upgrade/NFTMarketV1.sol [Line: 170](src/upgrade/NFTMarketV1.sol#L170)

	```solidity
	            payable(msg.sender).transfer(msg.value - price);
	```

- Found in src/upgrade/NFTMarketV2.sol [Line: 230](src/upgrade/NFTMarketV2.sol#L230)

	```solidity
	             payable(feeRecipient).transfer(platformFee);
	```

- Found in src/upgrade/NFTMarketV2.sol [Line: 232](src/upgrade/NFTMarketV2.sol#L232)

	```solidity
	         payable(seller).transfer(sellerAmount);
	```

- Found in src/upgrade/NFTMarketV2.sol [Line: 236](src/upgrade/NFTMarketV2.sol#L236)

	```solidity
	             payable(msg.sender).transfer(msg.value - price);
	```

</details>



## L-4: Unspecific Solidity Pragma

Consider using a specific version of Solidity in your contracts instead of a wide version. For example, instead of `pragma solidity ^0.8.0;`, use `pragma solidity 0.8.0;`

<details><summary>22 Found Instances</summary>


- Found in src/AirdopMerkleNFTMarket/AirdopMerkleNFTMarket.sol [Line: 2](src/AirdopMerkleNFTMarket/AirdopMerkleNFTMarket.sol#L2)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in src/AirdopMerkleNFTMarket/AirdropNFT.sol [Line: 2](src/AirdopMerkleNFTMarket/AirdropNFT.sol#L2)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in src/AirdopMerkleNFTMarket/Multicall.sol [Line: 2](src/AirdopMerkleNFTMarket/Multicall.sol#L2)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in src/AirdopMerkleNFTMarket/MulticallHelper.sol [Line: 2](src/AirdopMerkleNFTMarket/MulticallHelper.sol#L2)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in src/AirdopMerkleNFTMarket/PermitToken.sol [Line: 2](src/AirdopMerkleNFTMarket/PermitToken.sol#L2)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in src/BaseERC20.sol [Line: 2](src/BaseERC20.sol#L2)

	```solidity
	pragma solidity ^0.8.0; // 指定Solidity编译器版本
	```

- Found in src/BaseERC721.sol [Line: 2](src/BaseERC721.sol#L2)

	```solidity
	pragma solidity ^0.8.0; // 指定Solidity编译器版本
	```

- Found in src/Counter.sol [Line: 2](src/Counter.sol#L2)

	```solidity
	pragma solidity ^0.8.13;
	```

- Found in src/Delegate.sol [Line: 2](src/Delegate.sol#L2)

	```solidity
	pragma solidity ^0.8.20;
	```

- Found in src/NFTMarket.sol [Line: 2](src/NFTMarket.sol#L2)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in src/call/ContractA.sol [Line: 2](src/call/ContractA.sol#L2)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in src/call/ContractB.sol [Line: 2](src/call/ContractB.sol#L2)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in src/delegatecall/CallComparison.sol [Line: 2](src/delegatecall/CallComparison.sol#L2)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in src/delegatecall/Proxy.sol [Line: 2](src/delegatecall/Proxy.sol#L2)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in src/delegatecall/Storage.sol [Line: 2](src/delegatecall/Storage.sol#L2)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in src/esRNT.sol [Line: 2](src/esRNT.sol#L2)

	```solidity
	pragma solidity ^0.8.13;
	```

- Found in src/tokenbank/EIP2612Token.sol [Line: 2](src/tokenbank/EIP2612Token.sol#L2)

	```solidity
	pragma solidity ^0.8.13;
	```

- Found in src/tokenbank/EIP2612TokenBank.sol [Line: 2](src/tokenbank/EIP2612TokenBank.sol#L2)

	```solidity
	pragma solidity ^0.8.13;
	```

- Found in src/tokenbank/Permit2.sol [Line: 2](src/tokenbank/Permit2.sol#L2)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in src/upgrade/NFTMarketV1.sol [Line: 2](src/upgrade/NFTMarketV1.sol#L2)

	```solidity
	pragma solidity ^0.8.20;
	```

- Found in src/upgrade/NFTMarketV2.sol [Line: 2](src/upgrade/NFTMarketV2.sol#L2)

	```solidity
	pragma solidity ^0.8.20;
	```

- Found in src/upgrade/UpgradeableNFT.sol [Line: 2](src/upgrade/UpgradeableNFT.sol#L2)

	```solidity
	pragma solidity ^0.8.20;
	```

</details>



## L-5: Address State Variable Set Without Checks

Check for `address(0)` when assigning values to address state variables.

<details><summary>5 Found Instances</summary>


- Found in src/AirdopMerkleNFTMarket/AirdropNFT.sol [Line: 29](src/AirdopMerkleNFTMarket/AirdropNFT.sol#L29)

	```solidity
	        marketContract = _marketContract;
	```

- Found in src/call/ContractA.sol [Line: 9](src/call/ContractA.sol#L9)

	```solidity
	        externalContract = _externalContract;
	```

- Found in src/call/ContractA.sol [Line: 28](src/call/ContractA.sol#L28)

	```solidity
	        externalContract = _externalContract;
	```

- Found in src/delegatecall/CallComparison.sol [Line: 19](src/delegatecall/CallComparison.sol#L19)

	```solidity
	        targetContract = _targetContract;
	```

- Found in src/delegatecall/Proxy.sol [Line: 17](src/delegatecall/Proxy.sol#L17)

	```solidity
	        implementation = _implementation;
	```

</details>



## L-6: Public Function Not Used Internally

If a function is marked public but is not used internally, consider marking it as `external`.

<details><summary>54 Found Instances</summary>


- Found in src/AirdopMerkleNFTMarket/AirdropNFT.sol [Line: 38](src/AirdopMerkleNFTMarket/AirdropNFT.sol#L38)

	```solidity
	    function mint(address to, string memory uri) public onlyOwner returns (uint256) {
	```

- Found in src/BaseERC721.sol [Line: 77](src/BaseERC721.sol#L77)

	```solidity
	    function supportsInterface(bytes4 interfaceId) public pure returns (bool) {
	```

- Found in src/BaseERC721.sol [Line: 87](src/BaseERC721.sol#L87)

	```solidity
	    function name() public view returns (string memory) {
	```

- Found in src/BaseERC721.sol [Line: 94](src/BaseERC721.sol#L94)

	```solidity
	    function symbol() public view returns (string memory) {
	```

- Found in src/BaseERC721.sol [Line: 101](src/BaseERC721.sol#L101)

	```solidity
	    function tokenURI(uint256 tokenId) public view returns (string memory) {
	```

- Found in src/BaseERC721.sol [Line: 111](src/BaseERC721.sol#L111)

	```solidity
	    function mint(address to, uint256 tokenId) public {
	```

- Found in src/BaseERC721.sol [Line: 124](src/BaseERC721.sol#L124)

	```solidity
	    function balanceOf(address owner) public view returns (uint256) {
	```

- Found in src/BaseERC721.sol [Line: 145](src/BaseERC721.sol#L145)

	```solidity
	    function approve(address to, uint256 tokenId) public {
	```

- Found in src/BaseERC721.sol [Line: 170](src/BaseERC721.sol#L170)

	```solidity
	    function setApprovalForAll(address operator, bool approved) public {
	```

- Found in src/BaseERC721.sol [Line: 196](src/BaseERC721.sol#L196)

	```solidity
	    function transferFrom(address from, address to, uint256 tokenId) public {
	```

- Found in src/BaseERC721.sol [Line: 210](src/BaseERC721.sol#L210)

	```solidity
	    function safeTransferFrom(
	```

- Found in src/Counter.sol [Line: 7](src/Counter.sol#L7)

	```solidity
	    function setNumber(uint256 newNumber) public {
	```

- Found in src/Counter.sol [Line: 11](src/Counter.sol#L11)

	```solidity
	    function increment() public {
	```

- Found in src/NFTMarket.sol [Line: 39](src/NFTMarket.sol#L39)

	```solidity
	    function list(address nftAddress, uint256 tokenId, uint256 price) public {
	```

- Found in src/NFTMarket.sol [Line: 61](src/NFTMarket.sol#L61)

	```solidity
	    function buyNFT(address nftAddress, uint256 tokenId) public {
	```

- Found in src/TransparentProxy.sol [Line: 58](src/TransparentProxy.sol#L58)

	```solidity
	    function init(uint x) public {
	```

- Found in src/TransparentProxy.sol [Line: 67](src/TransparentProxy.sol#L67)

	```solidity
	    function add(uint256 i) public {
	```

- Found in src/TransparentProxy.sol [Line: 75](src/TransparentProxy.sol#L75)

	```solidity
	    function get() public view returns(uint) {
	```

- Found in src/TransparentProxy.sol [Line: 93](src/TransparentProxy.sol#L93)

	```solidity
	    function add(uint256 i) public {
	```

- Found in src/TransparentProxy.sol [Line: 102](src/TransparentProxy.sol#L102)

	```solidity
	    function get() public view returns(uint) {
	```

- Found in src/UUPSProxy.sol [Line: 67](src/UUPSProxy.sol#L67)

	```solidity
	    function init(uint x) public {
	```

- Found in src/UUPSProxy.sol [Line: 76](src/UUPSProxy.sol#L76)

	```solidity
	    function add(uint256 i) public {
	```

- Found in src/UUPSProxy.sol [Line: 84](src/UUPSProxy.sol#L84)

	```solidity
	    function get() public view returns(uint) {
	```

- Found in src/UUPSProxy.sol [Line: 130](src/UUPSProxy.sol#L130)

	```solidity
	    function add(uint256 i) public {
	```

- Found in src/UUPSProxy.sol [Line: 139](src/UUPSProxy.sol#L139)

	```solidity
	    function get() public view returns(uint) {
	```

- Found in src/call/ContractA.sol [Line: 14](src/call/ContractA.sol#L14)

	```solidity
	    function delegateCallIncrement() public {
	```

- Found in src/call/ContractA.sol [Line: 22](src/call/ContractA.sol#L22)

	```solidity
	    function getCounter() public view returns (uint256) {
	```

- Found in src/call/ContractA.sol [Line: 27](src/call/ContractA.sol#L27)

	```solidity
	    function setExternalContract(address _externalContract) public {
	```

- Found in src/call/ContractA.sol [Line: 32](src/call/ContractA.sol#L32)

	```solidity
	    function normalCallIncrement() public {
	```

- Found in src/call/ContractB.sol [Line: 11](src/call/ContractB.sol#L11)

	```solidity
	    function increment() public {
	```

- Found in src/call/ContractB.sol [Line: 15](src/call/ContractB.sol#L15)

	```solidity
	    function getCounter() public view returns (uint256) {
	```

- Found in src/delegatecall/CallComparison.sol [Line: 26](src/delegatecall/CallComparison.sol#L26)

	```solidity
	    function useCall(uint256 _value) public {
	```

- Found in src/delegatecall/CallComparison.sol [Line: 41](src/delegatecall/CallComparison.sol#L41)

	```solidity
	    function useDelegateCall(uint256 _value) public {
	```

- Found in src/delegatecall/CallComparison.sol [Line: 58](src/delegatecall/CallComparison.sol#L58)

	```solidity
	    function getCurrentState() public view returns (uint256 _value, address _owner, address _lastCaller) {
	```

- Found in src/delegatecall/CallComparison.sol [Line: 65](src/delegatecall/CallComparison.sol#L65)

	```solidity
	    function resetState() public {
	```

- Found in src/delegatecall/Proxy.sol [Line: 24](src/delegatecall/Proxy.sol#L24)

	```solidity
	    function setValueViaDelegateCall(uint256 _value) public {
	```

- Found in src/delegatecall/Proxy.sol [Line: 39](src/delegatecall/Proxy.sol#L39)

	```solidity
	    function addValueViaDelegateCall(uint256 _amount) public {
	```

- Found in src/delegatecall/Proxy.sol [Line: 52](src/delegatecall/Proxy.sol#L52)

	```solidity
	    function delegateCallToImplementation(bytes memory data) public returns (bool success, bytes memory returnData) {
	```

- Found in src/delegatecall/Proxy.sol [Line: 61](src/delegatecall/Proxy.sol#L61)

	```solidity
	    function updateImplementation(address _newImplementation) public {
	```

- Found in src/delegatecall/Proxy.sol [Line: 70](src/delegatecall/Proxy.sol#L70)

	```solidity
	    function getValue() public view returns (uint256) {
	```

- Found in src/delegatecall/Proxy.sol [Line: 78](src/delegatecall/Proxy.sol#L78)

	```solidity
	    function getOwner() public view returns (address) {
	```

- Found in src/delegatecall/Storage.sol [Line: 18](src/delegatecall/Storage.sol#L18)

	```solidity
	    function setValue(uint256 _value) public {
	```

- Found in src/delegatecall/Storage.sol [Line: 28](src/delegatecall/Storage.sol#L28)

	```solidity
	    function getValue() public view returns (uint256) {
	```

- Found in src/delegatecall/Storage.sol [Line: 36](src/delegatecall/Storage.sol#L36)

	```solidity
	    function addValue(uint256 _amount) public {
	```

- Found in src/tokenbank/EIP2612Token.sol [Line: 59](src/tokenbank/EIP2612Token.sol#L59)

	```solidity
	    function mint(address to, uint256 amount) public onlyOwner {
	```

- Found in src/tokenbank/EIP2612Token.sol [Line: 76](src/tokenbank/EIP2612Token.sol#L76)

	```solidity
	    function burn(address from, uint256 amount) public onlyOwner {
	```

- Found in src/tokenbank/EIP2612Token.sol [Line: 85](src/tokenbank/EIP2612Token.sol#L85)

	```solidity
	    function burn(uint256 amount) public {
	```

- Found in src/upgrade/NFTMarketV1.sol [Line: 93](src/upgrade/NFTMarketV1.sol#L93)

	```solidity
	    function initialize(
	```

- Found in src/upgrade/NFTMarketV2.sol [Line: 133](src/upgrade/NFTMarketV2.sol#L133)

	```solidity
	    function initialize(
	```

- Found in src/upgrade/NFTMarketV2.sol [Line: 161](src/upgrade/NFTMarketV2.sol#L161)

	```solidity
	     function initializeV2() public reinitializer(2) {
	```

- Found in src/upgrade/UpgradeableNFT.sol [Line: 25](src/upgrade/UpgradeableNFT.sol#L25)

	```solidity
	    function initialize(
	```

- Found in src/upgrade/UpgradeableNFT.sol [Line: 39](src/upgrade/UpgradeableNFT.sol#L39)

	```solidity
	    function mint(address to, uint256 tokenId) public onlyOwner {
	```

- Found in src/upgrade/UpgradeableNFT.sol [Line: 48](src/upgrade/UpgradeableNFT.sol#L48)

	```solidity
	    function batchMint(address to, uint256[] memory tokenIds) public onlyOwner {
	```

- Found in src/upgrade/UpgradeableNFT.sol [Line: 58](src/upgrade/UpgradeableNFT.sol#L58)

	```solidity
	    function setBaseURI(string memory baseURI) public onlyOwner {
	```

</details>



## L-7: Literal Instead of Constant

Define and use `constant` variables instead of using literals. If the same constant literal value is used multiple times, create a constant state variable and reference it throughout the contract.

<details><summary>17 Found Instances</summary>


- Found in src/AirdopMerkleNFTMarket/Multicall.sol [Line: 22](src/AirdopMerkleNFTMarket/Multicall.sol#L22)

	```solidity
	                if (result.length < 68) revert("Multicall: call failed");
	```

- Found in src/AirdopMerkleNFTMarket/Multicall.sol [Line: 72](src/AirdopMerkleNFTMarket/Multicall.sol#L72)

	```solidity
	                if (result.length < 68) revert("Multicall: call failed");
	```

- Found in src/tokenbank/EIP2612Token.sol [Line: 40](src/tokenbank/EIP2612Token.sol#L40)

	```solidity
	            uint256 initialSupplyWei = initialSupply * 10**tokenDecimals;
	```

- Found in src/tokenbank/EIP2612Token.sol [Line: 60](src/tokenbank/EIP2612Token.sol#L60)

	```solidity
	        uint256 mintAmount = amount * 10**_decimals;
	```

- Found in src/tokenbank/EIP2612Token.sol [Line: 77](src/tokenbank/EIP2612Token.sol#L77)

	```solidity
	        uint256 burnAmount = amount * 10**_decimals;
	```

- Found in src/tokenbank/EIP2612Token.sol [Line: 86](src/tokenbank/EIP2612Token.sol#L86)

	```solidity
	        uint256 burnAmount = amount * 10**_decimals;
	```

- Found in src/tokenbank/EIP2612Token.sol [Line: 108](src/tokenbank/EIP2612Token.sol#L108)

	```solidity
	            uint256 transferAmount = amounts[i] * 10**_decimals;
	```

- Found in src/tokenbank/Permit2.sol [Line: 84](src/tokenbank/Permit2.sol#L84)

	```solidity
	        uint256 word = nonce >> 8; // nonce / 256
	```

- Found in src/tokenbank/Permit2.sol [Line: 85](src/tokenbank/Permit2.sol#L85)

	```solidity
	        uint256 bit = nonce & 0xff; // nonce % 256
	```

- Found in src/tokenbank/Permit2.sol [Line: 94](src/tokenbank/Permit2.sol#L94)

	```solidity
	        uint256 word = nonce >> 8; // nonce / 256
	```

- Found in src/tokenbank/Permit2.sol [Line: 95](src/tokenbank/Permit2.sol#L95)

	```solidity
	        uint256 bit = nonce & 0xff; // nonce % 256
	```

- Found in src/upgrade/NFTMarketV1.sol [Line: 102](src/upgrade/NFTMarketV1.sol#L102)

	```solidity
	        require(_platformFeeRate <= 1000, "Fee rate too high"); // 最大10%
	```

- Found in src/upgrade/NFTMarketV1.sol [Line: 156](src/upgrade/NFTMarketV1.sol#L156)

	```solidity
	        uint256 platformFee = (price * platformFeeRate) / 10000;
	```

- Found in src/upgrade/NFTMarketV1.sol [Line: 210](src/upgrade/NFTMarketV1.sol#L210)

	```solidity
	        require(_platformFeeRate <= 1000, "Fee rate too high"); // 最大10%
	```

- Found in src/upgrade/NFTMarketV1.sol [Line: 229](src/upgrade/NFTMarketV1.sol#L229)

	```solidity
	        return (price * platformFeeRate) / 10000;
	```

- Found in src/upgrade/NFTMarketV2.sol [Line: 140](src/upgrade/NFTMarketV2.sol#L140)

	```solidity
	        require(_platformFeeRate <= 1000, "Fee rate too high"); // 最大10%
	```

- Found in src/upgrade/NFTMarketV2.sol [Line: 276](src/upgrade/NFTMarketV2.sol#L276)

	```solidity
	         require(_platformFeeRate <= 1000, "Fee rate too high"); // 最大10%
	```

</details>



## L-8: Unsafe `ERC721::_mint()`

Using `ERC721::_mint()` can mint ERC721 tokens to addresses which don't support ERC721 tokens. Use `_safeMint()` instead of `_mint()` for ERC721 tokens.

<details><summary>2 Found Instances</summary>


- Found in src/upgrade/UpgradeableNFT.sol [Line: 40](src/upgrade/UpgradeableNFT.sol#L40)

	```solidity
	        _mint(to, tokenId);
	```

- Found in src/upgrade/UpgradeableNFT.sol [Line: 50](src/upgrade/UpgradeableNFT.sol#L50)

	```solidity
	            _mint(to, tokenIds[i]);
	```

</details>



## L-9: PUSH0 Opcode

Solc compiler version 0.8.20 switches the default target EVM version to Shanghai, which means that the generated bytecode will include PUSH0 opcodes. Be sure to select the appropriate EVM version in case you intend to deploy on a chain other than mainnet like L2 chains that may not support PUSH0, otherwise deployment of your contracts will fail.

<details><summary>25 Found Instances</summary>


- Found in src/AirdopMerkleNFTMarket/AirdopMerkleNFTMarket.sol [Line: 2](src/AirdopMerkleNFTMarket/AirdopMerkleNFTMarket.sol#L2)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in src/AirdopMerkleNFTMarket/AirdropNFT.sol [Line: 2](src/AirdopMerkleNFTMarket/AirdropNFT.sol#L2)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in src/AirdopMerkleNFTMarket/MerkleProof.sol [Line: 2](src/AirdopMerkleNFTMarket/MerkleProof.sol#L2)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in src/AirdopMerkleNFTMarket/Multicall.sol [Line: 2](src/AirdopMerkleNFTMarket/Multicall.sol#L2)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in src/AirdopMerkleNFTMarket/MulticallHelper.sol [Line: 2](src/AirdopMerkleNFTMarket/MulticallHelper.sol#L2)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in src/AirdopMerkleNFTMarket/PermitToken.sol [Line: 2](src/AirdopMerkleNFTMarket/PermitToken.sol#L2)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in src/BaseERC20.sol [Line: 2](src/BaseERC20.sol#L2)

	```solidity
	pragma solidity ^0.8.0; // 指定Solidity编译器版本
	```

- Found in src/BaseERC721.sol [Line: 2](src/BaseERC721.sol#L2)

	```solidity
	pragma solidity ^0.8.0; // 指定Solidity编译器版本
	```

- Found in src/Counter.sol [Line: 2](src/Counter.sol#L2)

	```solidity
	pragma solidity ^0.8.13;
	```

- Found in src/Delegate.sol [Line: 2](src/Delegate.sol#L2)

	```solidity
	pragma solidity ^0.8.20;
	```

- Found in src/NFTMarket.sol [Line: 2](src/NFTMarket.sol#L2)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in src/TransparentProxy.sol [Line: 2](src/TransparentProxy.sol#L2)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in src/UUPSProxy.sol [Line: 2](src/UUPSProxy.sol#L2)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in src/call/ContractA.sol [Line: 2](src/call/ContractA.sol#L2)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in src/call/ContractB.sol [Line: 2](src/call/ContractB.sol#L2)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in src/delegatecall/CallComparison.sol [Line: 2](src/delegatecall/CallComparison.sol#L2)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in src/delegatecall/Proxy.sol [Line: 2](src/delegatecall/Proxy.sol#L2)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in src/delegatecall/Storage.sol [Line: 2](src/delegatecall/Storage.sol#L2)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in src/esRNT.sol [Line: 2](src/esRNT.sol#L2)

	```solidity
	pragma solidity ^0.8.13;
	```

- Found in src/tokenbank/EIP2612Token.sol [Line: 2](src/tokenbank/EIP2612Token.sol#L2)

	```solidity
	pragma solidity ^0.8.13;
	```

- Found in src/tokenbank/EIP2612TokenBank.sol [Line: 2](src/tokenbank/EIP2612TokenBank.sol#L2)

	```solidity
	pragma solidity ^0.8.13;
	```

- Found in src/tokenbank/Permit2.sol [Line: 2](src/tokenbank/Permit2.sol#L2)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in src/upgrade/NFTMarketV1.sol [Line: 2](src/upgrade/NFTMarketV1.sol#L2)

	```solidity
	pragma solidity ^0.8.20;
	```

- Found in src/upgrade/NFTMarketV2.sol [Line: 2](src/upgrade/NFTMarketV2.sol#L2)

	```solidity
	pragma solidity ^0.8.20;
	```

- Found in src/upgrade/UpgradeableNFT.sol [Line: 2](src/upgrade/UpgradeableNFT.sol#L2)

	```solidity
	pragma solidity ^0.8.20;
	```

</details>



## L-10: Empty Block

Consider removing empty blocks.

<details><summary>3 Found Instances</summary>


- Found in src/upgrade/NFTMarketV1.sol [Line: 247](src/upgrade/NFTMarketV1.sol#L247)

	```solidity
	    function _authorizeUpgrade(address newImplementation) internal override onlyOwner {}
	```

- Found in src/upgrade/NFTMarketV2.sol [Line: 449](src/upgrade/NFTMarketV2.sol#L449)

	```solidity
	    function _authorizeUpgrade(address newImplementation) internal override onlyOwner {}
	```

- Found in src/upgrade/UpgradeableNFT.sol [Line: 66](src/upgrade/UpgradeableNFT.sol#L66)

	```solidity
	    function _setBaseURI(string memory baseURI) internal {
	```

</details>



## L-11: Large Numeric Literal

Large literal values multiples of 10000 can be replaced with scientific notation.Use `e` notation, for example: `1e18`, instead of its full numeric value.

<details><summary>3 Found Instances</summary>


- Found in src/upgrade/NFTMarketV1.sol [Line: 156](src/upgrade/NFTMarketV1.sol#L156)

	```solidity
	        uint256 platformFee = (price * platformFeeRate) / 10000;
	```

- Found in src/upgrade/NFTMarketV1.sol [Line: 229](src/upgrade/NFTMarketV1.sol#L229)

	```solidity
	        return (price * platformFeeRate) / 10000;
	```

- Found in src/upgrade/NFTMarketV2.sol [Line: 222](src/upgrade/NFTMarketV2.sol#L222)

	```solidity
	         uint256 platformFee = (price * platformFeeRate) / 10000;
	```

</details>



## L-12: Internal Function Used Only Once

Instead of separating the logic into a separate function, consider inlining the logic into the calling function. This can reduce the number of function calls and improve readability.

<details><summary>4 Found Instances</summary>


- Found in src/AirdopMerkleNFTMarket/MerkleProof.sol [Line: 30](src/AirdopMerkleNFTMarket/MerkleProof.sol#L30)

	```solidity
	    function processProof(bytes32[] memory proof, bytes32 leaf) internal pure returns (bytes32) {
	```

- Found in src/AirdopMerkleNFTMarket/MerkleProof.sol [Line: 87](src/AirdopMerkleNFTMarket/MerkleProof.sol#L87)

	```solidity
	    function processMultiProof(
	```

- Found in src/BaseERC20.sol [Line: 76](src/BaseERC20.sol#L76)

	```solidity
	    function isContract(address account) internal view returns (bool) { // 判断地址是否为合约
	```

- Found in src/BaseERC721.sol [Line: 314](src/BaseERC721.sol#L314)

	```solidity
	    function isContract(address account) internal view returns (bool) {
	```

</details>



## L-13: Inconsistent uint256/uint (or) int256/int types

Inconsistency in declaring uint256/uint (or) int256/int variables within a contract. Use explicit size declarations (uint256 or int256). Consider keeping the naming convention consistent in a given contract. Explicit size declarations are preferred (uint256, int256) over implicit ones (uint, int) to avoid confusion.

<details><summary>12 Found Instances</summary>


- Found in src/TransparentProxy.sol [Line: 42](src/TransparentProxy.sol#L42)

	```solidity
	    uint private counter;  // 计数器状态变量
	```

- Found in src/TransparentProxy.sol [Line: 49](src/TransparentProxy.sol#L49)

	```solidity
	    constructor(uint x) {
	```

- Found in src/TransparentProxy.sol [Line: 58](src/TransparentProxy.sol#L58)

	```solidity
	    function init(uint x) public {
	```

- Found in src/TransparentProxy.sol [Line: 75](src/TransparentProxy.sol#L75)

	```solidity
	    function get() public view returns(uint) {
	```

- Found in src/TransparentProxy.sol [Line: 86](src/TransparentProxy.sol#L86)

	```solidity
	    uint private counter;  // 计数器状态变量（与V1保持相同的存储布局）
	```

- Found in src/TransparentProxy.sol [Line: 102](src/TransparentProxy.sol#L102)

	```solidity
	    function get() public view returns(uint) {
	```

- Found in src/UUPSProxy.sol [Line: 43](src/UUPSProxy.sol#L43)

	```solidity
	    uint private counter;  // 计数器状态变量
	```

- Found in src/UUPSProxy.sol [Line: 58](src/UUPSProxy.sol#L58)

	```solidity
	    constructor(uint x) {
	```

- Found in src/UUPSProxy.sol [Line: 67](src/UUPSProxy.sol#L67)

	```solidity
	    function init(uint x) public {
	```

- Found in src/UUPSProxy.sol [Line: 84](src/UUPSProxy.sol#L84)

	```solidity
	    function get() public view returns(uint) {
	```

- Found in src/UUPSProxy.sol [Line: 123](src/UUPSProxy.sol#L123)

	```solidity
	    uint private counter;  // 计数器状态变量（与V1保持相同的存储布局）
	```

- Found in src/UUPSProxy.sol [Line: 139](src/UUPSProxy.sol#L139)

	```solidity
	    function get() public view returns(uint) {
	```

</details>



## L-14: Loop Contains `require`/`revert`

Avoid `require` / `revert` statements in a loop because a single bad item can cause the whole transaction to fail. It's better to forgive on fail and return failed elements post processing of the loop

<details><summary>9 Found Instances</summary>


- Found in src/AirdopMerkleNFTMarket/AirdropNFT.sol [Line: 57](src/AirdopMerkleNFTMarket/AirdropNFT.sol#L57)

	```solidity
	        for (uint256 i = 0; i < uris.length; i++) {
	```

- Found in src/AirdopMerkleNFTMarket/Multicall.sol [Line: 17](src/AirdopMerkleNFTMarket/Multicall.sol#L17)

	```solidity
	        for (uint256 i = 0; i < data.length; i++) {
	```

- Found in src/AirdopMerkleNFTMarket/Multicall.sol [Line: 68](src/AirdopMerkleNFTMarket/Multicall.sol#L68)

	```solidity
	        for (uint256 i = 0; i < data.length; i++) {
	```

- Found in src/AirdopMerkleNFTMarket/PermitToken.sol [Line: 38](src/AirdopMerkleNFTMarket/PermitToken.sol#L38)

	```solidity
	        for (uint256 i = 0; i < recipients.length; i++) {
	```

- Found in src/Delegate.sol [Line: 73](src/Delegate.sol#L73)

	```solidity
	        for (uint256 i = 0; i < callCount; i++) {
	```

- Found in src/Delegate.sol [Line: 120](src/Delegate.sol#L120)

	```solidity
	        for (uint256 i = 0; i < callCount; i++) {
	```

- Found in src/tokenbank/EIP2612Token.sol [Line: 107](src/tokenbank/EIP2612Token.sol#L107)

	```solidity
	        for (uint256 i = 0; i < recipients.length; i++) {
	```

- Found in src/tokenbank/Permit2.sol [Line: 166](src/tokenbank/Permit2.sol#L166)

	```solidity
	        for (uint256 i = 0; i < nonces.length; i++) {
	```

- Found in src/upgrade/UpgradeableNFT.sol [Line: 49](src/upgrade/UpgradeableNFT.sol#L49)

	```solidity
	        for (uint256 i = 0; i < tokenIds.length; i++) {
	```

</details>



## L-15: Local Variable Shadows State Variable

Rename the local variable that shadows another state variable.

<details><summary>1 Found Instances</summary>


- Found in src/tokenbank/EIP2612TokenBank.sol [Line: 52](src/tokenbank/EIP2612TokenBank.sol#L52)

	```solidity
	    constructor(IERC20 _asset, address _permit2)
	```

</details>



## L-16: Costly operations inside loop

Invoking `SSTORE` operations in loops may waste gas. Use a local variable to hold the loop computation result.

<details><summary>6 Found Instances</summary>


- Found in src/AirdopMerkleNFTMarket/AirdropNFT.sol [Line: 57](src/AirdopMerkleNFTMarket/AirdropNFT.sol#L57)

	```solidity
	        for (uint256 i = 0; i < uris.length; i++) {
	```

- Found in src/AirdopMerkleNFTMarket/PermitToken.sol [Line: 38](src/AirdopMerkleNFTMarket/PermitToken.sol#L38)

	```solidity
	        for (uint256 i = 0; i < recipients.length; i++) {
	```

- Found in src/tokenbank/EIP2612Token.sol [Line: 107](src/tokenbank/EIP2612Token.sol#L107)

	```solidity
	        for (uint256 i = 0; i < recipients.length; i++) {
	```

- Found in src/tokenbank/Permit2.sol [Line: 166](src/tokenbank/Permit2.sol#L166)

	```solidity
	        for (uint256 i = 0; i < nonces.length; i++) {
	```

- Found in src/upgrade/NFTMarketV2.sol [Line: 425](src/upgrade/NFTMarketV2.sol#L425)

	```solidity
	        for (uint256 i = 0; i < nftContracts.length; i++) {
	```

- Found in src/upgrade/UpgradeableNFT.sol [Line: 49](src/upgrade/UpgradeableNFT.sol#L49)

	```solidity
	        for (uint256 i = 0; i < tokenIds.length; i++) {
	```

</details>



## L-17: Missing Inheritance

There is an interface / abstract contract that is potentially missing (not included in) the inheritance of this contract.

<details><summary>2 Found Instances</summary>


- Found in src/BaseERC721.sol [Line: 9](src/BaseERC721.sol#L9)

	Is this contract supposed to implement an interface? Consider extending one of the following: ERC165, ERC165Upgradeable, ERC721, ERC721URIStorage, ERC721Upgradeable, IERC165, IERC721, IERC721Metadata
	```solidity
	contract BaseERC721 {
	```

- Found in src/delegatecall/Proxy.sol [Line: 8](src/delegatecall/Proxy.sol#L8)

	Is this contract supposed to implement an interface? Consider extending one of the following: IBeacon
	```solidity
	contract Proxy {
	```

</details>



## L-18: Unused Import

Redundant import statement. Consider removing it.

<details><summary>2 Found Instances</summary>


- Found in src/AirdopMerkleNFTMarket/MulticallHelper.sol [Line: 4](src/AirdopMerkleNFTMarket/MulticallHelper.sol#L4)

	```solidity
	import "./AirdopMerkleNFTMarket.sol";
	```

- Found in src/BaseERC721.sol [Line: 5](src/BaseERC721.sol#L5)

	```solidity
	import "@openzeppelin/contracts/utils/Context.sol"; // 导入OpenZeppelin的Context工具库
	```

</details>



## L-19: State Change Without Event

There are state variable changes in this function but no event is emitted. Consider emitting an event to enable offchain indexers to track the changes.

<details><summary>21 Found Instances</summary>


- Found in src/AirdopMerkleNFTMarket/AirdropNFT.sol [Line: 28](src/AirdopMerkleNFTMarket/AirdropNFT.sol#L28)

	```solidity
	    function setMarketContract(address _marketContract) external onlyOwner {
	```

- Found in src/Counter.sol [Line: 7](src/Counter.sol#L7)

	```solidity
	    function setNumber(uint256 newNumber) public {
	```

- Found in src/Counter.sol [Line: 11](src/Counter.sol#L11)

	```solidity
	    function increment() public {
	```

- Found in src/NFTMarket.sol [Line: 39](src/NFTMarket.sol#L39)

	```solidity
	    function list(address nftAddress, uint256 tokenId, uint256 price) public {
	```

- Found in src/NFTMarket.sol [Line: 61](src/NFTMarket.sol#L61)

	```solidity
	    function buyNFT(address nftAddress, uint256 tokenId) public {
	```

- Found in src/NFTMarket.sol [Line: 81](src/NFTMarket.sol#L81)

	```solidity
	    function tokensReceived(address from, uint256 amount, bytes calldata data) external {
	```

- Found in src/TransparentProxy.sol [Line: 58](src/TransparentProxy.sol#L58)

	```solidity
	    function init(uint x) public {
	```

- Found in src/TransparentProxy.sol [Line: 67](src/TransparentProxy.sol#L67)

	```solidity
	    function add(uint256 i) public {
	```

- Found in src/TransparentProxy.sol [Line: 93](src/TransparentProxy.sol#L93)

	```solidity
	    function add(uint256 i) public {
	```

- Found in src/UUPSProxy.sol [Line: 67](src/UUPSProxy.sol#L67)

	```solidity
	    function init(uint x) public {
	```

- Found in src/UUPSProxy.sol [Line: 76](src/UUPSProxy.sol#L76)

	```solidity
	    function add(uint256 i) public {
	```

- Found in src/UUPSProxy.sol [Line: 130](src/UUPSProxy.sol#L130)

	```solidity
	    function add(uint256 i) public {
	```

- Found in src/call/ContractA.sol [Line: 27](src/call/ContractA.sol#L27)

	```solidity
	    function setExternalContract(address _externalContract) public {
	```

- Found in src/call/ContractB.sol [Line: 11](src/call/ContractB.sol#L11)

	```solidity
	    function increment() public {
	```

- Found in src/delegatecall/CallComparison.sol [Line: 65](src/delegatecall/CallComparison.sol#L65)

	```solidity
	    function resetState() public {
	```

- Found in src/delegatecall/Proxy.sol [Line: 61](src/delegatecall/Proxy.sol#L61)

	```solidity
	    function updateImplementation(address _newImplementation) public {
	```

- Found in src/tokenbank/Permit2.sol [Line: 165](src/tokenbank/Permit2.sol#L165)

	```solidity
	    function invalidateNonces(uint256[] calldata nonces) external {
	```

- Found in src/upgrade/NFTMarketV1.sol [Line: 209](src/upgrade/NFTMarketV1.sol#L209)

	```solidity
	    function setPlatformFeeRate(uint256 _platformFeeRate) external onlyOwner {
	```

- Found in src/upgrade/NFTMarketV1.sol [Line: 218](src/upgrade/NFTMarketV1.sol#L218)

	```solidity
	    function setFeeRecipient(address _feeRecipient) external onlyOwner {
	```

- Found in src/upgrade/NFTMarketV2.sol [Line: 275](src/upgrade/NFTMarketV2.sol#L275)

	```solidity
	     function setPlatformFeeRate(uint256 _platformFeeRate) external onlyOwner {
	```

- Found in src/upgrade/NFTMarketV2.sol [Line: 284](src/upgrade/NFTMarketV2.sol#L284)

	```solidity
	     function setFeeRecipient(address _feeRecipient) external onlyOwner {
	```

</details>



## L-20: State Variable Could Be Immutable

State variables that are only changed in the constructor should be declared immutable to save gas. Add the `immutable` attribute to state variables that are only changed in the constructor

<details><summary>6 Found Instances</summary>


- Found in src/BaseERC721.sol [Line: 14](src/BaseERC721.sol#L14)

	```solidity
	    string private _name; // 代币名称
	```

- Found in src/BaseERC721.sol [Line: 17](src/BaseERC721.sol#L17)

	```solidity
	    string private _symbol; // 代币符号
	```

- Found in src/BaseERC721.sol [Line: 20](src/BaseERC721.sol#L20)

	```solidity
	    string private _baseURI; // 代币基础URI
	```

- Found in src/call/ContractA.sol [Line: 5](src/call/ContractA.sol#L5)

	```solidity
	    uint256 public counter;           // 参数2：counter (必须放在第一个slot以匹配ContractB)
	```

- Found in src/delegatecall/CallComparison.sol [Line: 13](src/delegatecall/CallComparison.sol#L13)

	```solidity
	    address public targetContract;
	```

- Found in src/tokenbank/EIP2612Token.sol [Line: 15](src/tokenbank/EIP2612Token.sol#L15)

	```solidity
	    uint8 private _decimals;
	```

</details>



